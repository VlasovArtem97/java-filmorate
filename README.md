# **Filmorate**
___
## Что же такое Filmorate  
**Filmorate** — это Java-приложение для управления пользователями 
и фильмами с возможностью взаимодействия между ними. Проект предоставляет функционал для работы с пользователями 
и фильмами, включая управление друзьями и рейтингом фильмов.
Template repository for Filmorate project.  
___
## Основные возможности

### Пользователи
- Добавление нового пользователя.
- Обновление данных существующего пользователя.
- Получение списка всех пользователей.
- Поиск пользователя по идентификатору.
- Добавление пользователя в список друзей.
- Удаление пользователя из списка друзей.
- Получение списка друзей пользователя.
- Получение списка общих друзей между двумя пользователями.

### Фильмы
- Добавление нового фильма.
- Обновление данных существующего фильма.
- Получение списка всех фильмов.
- Поиск фильма по идентификатору.
- Поставить лайк фильму от имени пользователя.
- Удалить лайк фильму.
- Получение списка популярных фильмов (отсортированных по 
количеству лайков).
___
## Технологии

- Язык программирования: Java
- Фреймворк: Spring Boot
- База данных: PostgreSQL
- Система сборки: Maven
___
## Диаграмма базы данных
![](src/main/resources/image/БД.png)

### Пояснения к диаграмме
- Таблица `users` хранит информацию о пользователях приложения.
- Таблица `films` содержит данные о фильмах.
- Таблица `friendship` реализует 
двунаправленную связь «друзья» между пользователями и представляет собой:
  - Одна запись `(user_id, friend_id)` означает, что пользователь отправил заявку в друзья — дружба не подтверждена.
  - Вторая запись `(friend_id, user_id)` появляется при подтверждении заявки — дружба становится взаимной.
  - Таким образом, одна запись = заявка в ожидании, две записи = подтверждённая дружба. Связь - «многие ко многим».
- Таблица `film_likes` связывает пользователей и фильмы, позволяя пользователям ставить лайки фильмам. Каждая запись отражает факт, что пользователь user_id поставил лайк фильму film_id. Связь - «многие ко многим»
- `films.rating_id` — внешний ключ на таблицу `ratings_ak`, где хранится рейтинг фильма (MPA, PG, R и т.п.).
- Таблица `genres` — справочник жанров (комедия, драма, фантастика и т.д.).
- Таблица `genres_films` — связующая таблица для реализации связи «многие ко многим» между фильмами и жанрами.
___

## Примеры SQL-запросов для основных операций Filmorate

- ### Получить пользователя по ID
```
SELECT * 
FROM users 
WHERE user_id = 1;
```
- ### Получение всех пользователей
```
SELECT * 
FROM users;
```
- ### Получить фильм по ID
```
SELECT * 
FROM films 
WHERE film_id = 1;
```
- ### Получение всех фильмов
```
SELECT * 
FROM films;
```
- ### Получить 10 популярных фильмов (в соответствии с количеством лайков)
```
SELECT f.film_id, f.title, COUNT(fl.user_id) AS likes_count
FROM films AS f
LEFT JOIN film_likes AS fl ON f.film_id = fl.film_id
GROUP BY f.film_id, f.title
ORDER BY likes_count DESC
LIMIT 10;
```
- ### Получить список фильмов с жанром комедия и рейтингом PG
```
SELECT f.*
FROM films AS f
INNER JOIN genres_film AS fg ON f.film_id = fg.film_id
INNER JOIN genres AS g ON fg.genre_id = g.genre_id
INNER JOIN ratings_ak AS r ON f.rating_id = r.rating_id
WHERE g.name = 'Комедия' AND r.name = 'PG';
```
___
# Конец :japanese_goblin: :vampire_man:
